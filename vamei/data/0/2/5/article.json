{"content":"<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x4F5C;&#x8005;&#xFF1A;Vamei &#x51FA;&#x5904;&#xFF1A;http://www.cnblogs.com/vamei &#x6B22;&#x8FCE;&#x8F6C;&#x8F7D;&#xFF0C;&#x4E5F;&#x8BF7;&#x4FDD;&#x7559;&#x8FD9;&#x6BB5;&#x58F0;&#x660E;&#x3002;&#x8C22;&#x8C22;&#xFF01;</span></p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#xA0;</span></p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\"><span style=\"color: #ff0000;\">&#x7528;&#x6237;&#x9A8C;&#x8BC1;</span>(User Authentification)&#x590D;&#x5408;&#x7684;&#x4F7F;&#x7528;Play&#x6846;&#x67B6;&#x7684;&#x6570;&#x4E2A;&#x529F;&#x80FD;&#xFF0C;&#x5305;&#x62EC;&#x524D;&#x9762;&#x5DF2;&#x7ECF;&#x4E86;&#x89E3;&#x7684;&#x8868;&#x5355;&#x548C;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x4EE5;&#x53CA;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x91CC;&#x8981;&#x63D0;&#x5230;&#x7684;&#x52A0;&#x5BC6;&#x548C;&#x4F1A;&#x8BDD;&#x3002;&#x6839;&#x636E;&#x5E94;&#x7528;&#x6216;&#x7AD9;&#x70B9;&#x7684;&#x590D;&#x6742;&#x7A0B;&#x5EA6;&#xFF0C;&#x7528;&#x6237;&#x9A8C;&#x8BC1;&#x4E5F;&#x53EF;&#x4EE5;&#x968F;&#x4E4B;&#x53D8;&#x5316;&#x3002;&#x8FD9;&#x91CC;&#x5C06;&#x4ECB;&#x7ECD;&#x7528;&#x6237;&#x9A8C;&#x8BC1;&#x7684;&#x4E00;&#x4E2A;&#x57FA;&#x672C;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;&#x3002;</span></p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#xA0;</span></p>\r\n<h3><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x52A0;&#x5BC6;</span></h3>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x4E3A;&#x4E86;&#x4FE1;&#x606F;&#x5B89;&#x5168;&#xFF0C;&#x7528;&#x6237;&#x5BC6;&#x7801;&#x9700;&#x8981;&#x52A0;&#x5BC6;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x4FDD;&#x5B58;&#x4E3A;&#x660E;&#x6587;&#x3002;Bcrypt&#x7B97;&#x6CD5;&#x53EF;&#x4EE5;&#x5BF9;&#x660E;&#x6587;&#x5BC6;&#x7801;&#x8FDB;&#x884C;<span style=\"color: #ff0000;\">&#x54C8;&#x5E0C;</span>(Hash)&#x8F6C;&#x6362;&#x3002;&#x6211;&#x4FDD;&#x5B58;&#x5728;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x7684;&#x5BC6;&#x7801;&#xFF0C;&#x662F;&#x7ECF;&#x8FC7;&#x8F6C;&#x6362;&#x540E;&#x7684;&#x6587;&#x672C;&#x3002;</span></p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#xA0;</span></p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">JBcrypt&#x662F;&#x4E00;&#x4E2A;&#x5916;&#x90E8;&#x7684;&#x5305;&#xFF0C;&#x63D0;&#x4F9B;&#x4E86;Bcrypt&#x529F;&#x80FD;&#x3002;&#x8981;&#x5728;build.sbt&#x4E2D;&#x8BF4;&#x660E;&#x8FD9;&#x4E2A;&#x5305;&#x7684;&#x6765;&#x6E90;&#x548C;&#x7248;&#x672C;&#xFF1A;</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-family: &apos;courier new&apos;, courier;\">name := &quot;test&quot;<span style=\"color: #000000;\">\r\n\r\nversion :</span>= &quot;1.0-SNAPSHOT&quot;<span style=\"color: #000000;\">\r\n\r\nlibraryDependencies </span>++=<span style=\"color: #000000;\"> Seq(\r\n  javaJdbc,\r\n  javaEbean,\r\n  cache,\r\n  </span>&quot;mysql&quot; % &quot;mysql-connector-java&quot; % &quot;5.1.18&quot;<span style=\"color: #000000;\">,\r\n  </span><span style=\"color: #ff0000;\">&quot;org.mindrot&quot; % &quot;jbcrypt&quot; % &quot;0.3m&quot;</span><span style=\"color: #000000;\">\r\n)\r\n\r\nplay.Project.playJavaSettings</span></span></pre>\r\n</div>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x5373;&#x4E0A;&#x9762;&#x65B0;&#x589E;&#x7684;jbcrypt&#x884C;&#x3002;&#x91CD;&#x65B0;&#x8FD0;&#x884C;Play&#x540E;&#x5373;&#x53EF;&#x4F7F;&#x7528;&#x3002;&#x4E3A;&#x4E86;Eclipse&#x80FD;&#x81EA;&#x52A8;&#x8865;&#x9F50;&#x8BE5;&#x5305;&#x7684;&#x76F8;&#x5173;&#x8C03;&#x7528;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;play eclipse&#xFF0C;&#x5E76;&#x91CD;&#x65B0;&#x5728;Eclipse&#x5F15;&#x5165;&#x9879;&#x76EE;&#x3002;</span></p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#xA0;</span></p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x6211;&#x4E0B;&#x9762;&#x7528;&#x4E00;&#x4E2A;&#x5C0F;&#x4F8B;&#x5B50;&#xFF0C;&#x6765;&#x8BF4;&#x660E;&#x8BE5;Bcrypt&#x7684;&#x54C8;&#x5E0C;&#x8F6C;&#x6362;&#x3002;&#x5728;Play&#x4E2D;&#x589E;&#x52A0;&#x52A8;&#x4F5C;&#xFF1A;</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-family: &apos;courier new&apos;, courier;\"><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span><span style=\"color: #000000;\"> Result bcrypt() {\r\n    String passwordHash </span>= BCrypt.hashpw(&quot;Hello&quot;<span style=\"color: #000000;\">,BCrypt.gensalt());\r\n    </span><span style=\"color: #0000ff;\">boolean</span> correct = BCrypt.checkpw(&quot;Hello&quot;<span style=\"color: #000000;\">, passwordHash);\r\n    </span><span style=\"color: #0000ff;\">boolean</span> wrong = BCrypt.checkpw(&quot;World&quot;<span style=\"color: #000000;\">, passwordHash);\r\n    </span><span style=\"color: #0000ff;\">return</span> ok(passwordHash + &quot; &quot; + correct + &quot; &quot; +<span style=\"color: #000000;\"> wrong);\r\n}</span></span></pre>\r\n</div>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x4E0A;&#x9762;&#x7A0B;&#x5E8F;&#x9700;&#x5F15;&#x5165;org.mindrot.jbcrypt.BCrypt&#x3002;&#x52A8;&#x4F5C;&#x4E2D;&#x5BF9;&quot;Hello&quot;&#x5B57;&#x7B26;&#x4E32;&#x8FDB;&#x884C;&#x4E86;&#x54C8;&#x5E0C;&#x8F6C;&#x6362;&#xFF0C;&#x5E76;&#x9A8C;&#x8BC1;&quot;Hello&quot;&#x548C;&quot;World&quot;&#x662F;&#x5426;&#x4E3A;&#x539F;&#x59CB;&#x7684;&#x660E;&#x6587;&#x6587;&#x672C;&#x3002;</span></p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#xA0;</span></p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x5728;routes&#x589E;&#x52A0;&#x5BF9;&#x5E94;URL&#xFF0C;/bcrypt</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-family: &apos;courier new&apos;, courier;\">GET     /bcrypt                     controllers.Application.bcrypt()</span></pre>\r\n</div>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#xA0;</span></p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x8BBF;&#x95EE;&#x9875;&#x9762;&#xFF1A;</span></p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\"><img style=\"display: block; margin-left: auto; margin-right: auto;\" src=\"http://images.cnitblog.com/i/413416/201405/110809418231775.png\" alt=\"\"></span></p>\r\n<h3><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x7528;&#x6237;&#x6CE8;&#x518C;</span></h3>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x6709;&#x4E86;<a href=\"http://www.cnblogs.com/vamei/p/3708612.html\">&#x8868;&#x5355;</a>&#x3001;<a href=\"http://www.cnblogs.com/vamei/p/3713820.html\">&#x6570;&#x636E;&#x5E93;</a>&#x548C;&#x52A0;&#x5BC6;&#x7684;&#x57FA;&#x7840;&#xFF0C;&#x7528;&#x6237;&#x6CE8;&#x518C;&#x5F88;&#x5BB9;&#x6613;&#x5B9E;&#x73B0;&#x3002;&#x9996;&#x5148;&#x5EFA;&#x7ACB;&#x6570;&#x636E;&#x6A21;&#x578B;app/models/User.java&#xFF1A;</span></p>\r\n<p>&#xA0;</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-family: &apos;courier new&apos;, courier;\"><span style=\"color: #0000ff;\">package</span><span style=\"color: #000000;\"> models;\r\n\r\n</span><span style=\"color: #0000ff;\">import</span> javax.persistence.*<span style=\"color: #000000;\">;\r\n</span><span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> play.db.ebean.Model;\r\n</span><span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> org.mindrot.jbcrypt.BCrypt;\r\n\r\n\r\n\r\n@Entity\r\n</span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span> User <span style=\"color: #0000ff;\">extends</span><span style=\"color: #000000;\"> Model {\r\n    @Id    \r\n    </span><span style=\"color: #0000ff;\">private</span><span style=\"color: #000000;\"> String email;\r\n    </span><span style=\"color: #0000ff;\">private</span><span style=\"color: #000000;\"> String password;\r\n    \r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> Constructor</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> User(String email, String password) {\r\n        String passwordHash </span>=<span style=\"color: #000000;\"> BCrypt.hashpw(password, BCrypt.gensalt());\r\n        </span><span style=\"color: #0000ff;\">this</span>.email =<span style=\"color: #000000;\"> email;\r\n        </span><span style=\"color: #0000ff;\">this</span>.password =<span style=\"color: #000000;\"> passwordHash;\r\n    }\r\n}</span></span></pre>\r\n</div>\r\n<p>&#xA0;</p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x521B;&#x5EFA;&#x4E86;User&#x7C7B;&#xFF0C;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x5C5E;&#x6027;email&#x548C;password&#x3002;&#x5728;&#x6784;&#x9020;&#x5668;&#x4E2D;&#xFF0C;&#x6211;&#x5BF9;&#x5BC6;&#x7801;&#x8FDB;&#x884C;&#x4E86;&#x54C8;&#x5E0C;&#x8F6C;&#x6362;&#x3002;</span></p>\r\n<p>&#xA0;</p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x4E0B;&#x9762;&#x4FEE;&#x6539;&#x63A7;&#x5236;&#x5668;Application(app/controllers/Application.java)&#x3002;&#x63A7;&#x5236;&#x5668;&#x4E2D;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x52A8;&#x4F5C;&#x548C;&#x4E00;&#x4E2A;&#x8868;&#x5355;&#x7C7B;Registration&#x3002;&#x4E00;&#x4E2A;&#x52A8;&#x4F5C;register()&#x7528;&#x4E8E;&#x663E;&#x793A;&#x6CE8;&#x518C;&#x9875;&#x9762;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x52A8;&#x4F5C;postRegister&#x5904;&#x7406;&#x8868;&#x5355;&#x63D0;&#x4EA4;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x5E76;&#x589E;&#x52A0;&#x76F8;&#x5E94;&#x7684;&#x6570;&#x636E;&#x5E93;&#x8BB0;&#x5F55;&#x3002;Registration&#x5219;&#x5BF9;&#x5E94;&#x6CE8;&#x518C;&#x9875;&#x9762;&#x6240;&#x663E;&#x793A;&#x7684;&#x8868;&#x683C;&#xFF1A;<br></span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-family: &apos;courier new&apos;, courier;\"><span style=\"color: #0000ff;\">package</span><span style=\"color: #000000;\"> controllers;\r\n\r\n</span><span style=\"color: #0000ff;\">import</span> play.*<span style=\"color: #000000;\">;\r\n</span><span style=\"color: #0000ff;\">import</span> play.mvc.*<span style=\"color: #000000;\">;\r\n</span><span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> play.data.Form;\r\n</span><span style=\"color: #0000ff;\">import</span> play.data.validation.Constraints.*<span style=\"color: #000000;\">;</span><span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> models.User;\r\n\r\n</span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span> Application <span style=\"color: #0000ff;\">extends</span><span style=\"color: #000000;\"> Controller {\r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> Registration {\r\n        @Email\r\n        </span><span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> String email;\r\n        @Required\r\n        </span><span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> String password;\r\n    }\r\n    \r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span><span style=\"color: #000000;\"> Result register() {\r\n        Form</span>&lt;Registration&gt; userForm = Form.form(Registration.<span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> ok(views.html.register.render(userForm));\r\n    }\r\n    \r\n\r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span><span style=\"color: #000000;\"> Result postRegister() {\r\n        Form</span>&lt;Registration&gt; userForm =<span style=\"color: #000000;\"> \r\n                Form.form(Registration.</span><span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\">).bindFromRequest();\r\n        User user </span>= <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> User(userForm.get().email, userForm.get().password);\r\n        user.save(); \r\n        </span><span style=\"color: #0000ff;\">return</span> ok(&quot;registered&quot;<span style=\"color: #000000;\">); \r\n    }\r\n}</span></span></pre>\r\n</div>\r\n<p>&#xA0;</p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">register()&#x52A8;&#x4F5C;&#x4F7F;&#x7528;&#x7684;&#x6A21;&#x677F;&#x4E3A;<span style=\"color: #800000;\">app/views/register.scala.html</span>:</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-family: &apos;courier new&apos;, courier;\"><span style=\"color: #000000;\">@(userForm: Form[controllers.Application.Registration])\r\n\r\n</span><span style=\"color: #0000ff;\">&lt;!</span><span style=\"color: #ff00ff;\">DOCTYPE html</span><span style=\"color: #0000ff;\">&gt;</span>\r\n<span style=\"color: #0000ff;\">&lt;</span><span style=\"color: #800000;\">html</span><span style=\"color: #0000ff;\">&gt;</span>\r\n  <span style=\"color: #0000ff;\">&lt;</span><span style=\"color: #800000;\">body</span><span style=\"color: #0000ff;\">&gt;</span>\r\n    <span style=\"color: #0000ff;\">&lt;</span><span style=\"color: #800000;\">h1</span><span style=\"color: #0000ff;\">&gt;</span> Registration <span style=\"color: #0000ff;\">&lt;/</span><span style=\"color: #800000;\">h1</span><span style=\"color: #0000ff;\">&gt;</span><span style=\"color: #000000;\">\r\n    @helper.form(action = routes.Application.postRegister()) {\r\n      @helper.inputText(userForm(&quot;email&quot;))\r\n      @helper.inputPassword(userForm(&quot;password&quot;))\r\n      </span><span style=\"color: #0000ff;\">&lt;</span><span style=\"color: #800000;\">input </span><span style=\"color: #ff0000;\">type</span><span style=\"color: #0000ff;\">=&quot;submit&quot;</span><span style=\"color: #0000ff;\">&gt;</span><span style=\"color: #000000;\">\r\n    }\r\n  </span><span style=\"color: #0000ff;\">&lt;/</span><span style=\"color: #800000;\">body</span><span style=\"color: #0000ff;\">&gt;</span>\r\n<span style=\"color: #0000ff;\">&lt;/</span><span style=\"color: #800000;\">html</span><span style=\"color: #0000ff;\">&gt;</span></span></pre>\r\n</div>\r\n<p>&#xA0;</p>\r\n<p>&#xA0;</p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x5728;routes&#x4E2D;&#x4E3A;&#x4E24;&#x4E2A;&#x52A8;&#x4F5C;&#x589E;&#x52A0;&#x5BF9;&#x5E94;&#x7684;URL&#xFF1A;</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #000000; font-family: &apos;courier new&apos;, courier;\">GET     /register                   controllers.Application.register()\r\nPOST    /register                   controllers.Application.postRegister()</span></pre>\r\n</div>\r\n<p>&#xA0;</p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x8BBF;&#x95EE;&#x9875;&#x9762;&#xFF1A;</span></p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\"><img style=\"display: block; margin-left: auto; margin-right: auto;\" src=\"http://images.cnitblog.com/i/413416/201405/110839525735035.png\" alt=\"\"></span></p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x8F93;&#x5165;&#x7528;&#x6237;&#x540D;&#x548C;&#x5BC6;&#x7801;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x589E;&#x52A0;&#x7684;&#x8BB0;&#x5F55;&#xFF1A;</span></p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\"><img style=\"display: block; margin-left: auto; margin-right: auto;\" src=\"http://images.cnitblog.com/i/413416/201405/110842241987391.png\" alt=\"\"></span></p>\r\n<h3><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x7528;&#x6237;&#x9A8C;&#x8BC1;</span></h3>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x5C06;&#x7528;&#x6237;&#x9A8C;&#x8BC1;&#x7684;&#x4E3B;&#x8981;&#x903B;&#x8F91;&#x653E;&#x5165;&#x5230;&#x6A21;&#x578B;User&#x4E2D;&#x3002;&#x4FEE;&#x6539;User&#x7C7B;&#xFF0C;&#x4E3A;User&#x7C7B;&#x589E;&#x52A0;authenticate()&#x65B9;&#x6CD5;&#xFF1A;</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-family: &apos;courier new&apos;, courier;\"><span style=\"color: #0000ff;\">package</span><span style=\"color: #000000;\"> models;\r\n\r\n</span><span style=\"color: #0000ff;\">import</span> javax.persistence.*<span style=\"color: #000000;\">;\r\n</span><span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> play.db.ebean.Model;\r\n</span><span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> org.mindrot.jbcrypt.BCrypt;\r\n\r\n@Entity\r\n</span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span> User <span style=\"color: #0000ff;\">extends</span><span style=\"color: #000000;\"> Model {\r\n    @Id    \r\n    </span><span style=\"color: #0000ff;\">private</span><span style=\"color: #000000;\"> String email;\r\n    </span><span style=\"color: #0000ff;\">private</span><span style=\"color: #000000;\"> String password;\r\n    \r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> Constructor</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> User(String email, String password) {\r\n        String passwordHash </span>=<span style=\"color: #000000;\"> BCrypt.hashpw(password, BCrypt.gensalt());\r\n        </span><span style=\"color: #0000ff;\">this</span>.email =<span style=\"color: #000000;\"> email;\r\n        </span><span style=\"color: #0000ff;\">this</span>.password =<span style=\"color: #000000;\"> passwordHash;\r\n    }\r\n\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> Query</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span> Model.Finder&lt;Integer, User&gt; find = \r\n        <span style=\"color: #0000ff;\">new</span> Model.Finder&lt;&gt;(Integer.<span style=\"color: #0000ff;\">class</span>, User.<span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\">);\r\n            \r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> Authentification</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span><span style=\"color: #000000;\"> User authenticate(String email, String password) {\r\n        User user </span>=<span style=\"color: #000000;\">  find.where()\r\n                .eq(</span>&quot;email&quot;<span style=\"color: #000000;\">, email)\r\n                .findUnique();\r\n        </span><span style=\"color: #0000ff;\">if</span> (user == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">) {\r\n            </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> user;\r\n        } </span><span style=\"color: #0000ff;\">else</span> <span style=\"color: #0000ff;\">if</span><span style=\"color: #000000;\"> (BCrypt.checkpw(password, user.password)) {\r\n            </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> user;\r\n        } </span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\"> {\r\n            </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n        }\r\n    }\r\n}</span></span></pre>\r\n</div>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">authenticate()&#x63A5;&#x6536;&#x7684;&#x662F;&#x660E;&#x6587;&#x5BC6;&#x7801;&#x3002;&#x4E0A;&#x9762;&#x7684;&#x9A8C;&#x8BC1;&#x4E2D;&#xFF0C;&#x9996;&#x5148;&#x68C0;&#x67E5;&#x7528;&#x6237;&#x90AE;&#x7BB1;&#x662F;&#x5426;&#x5B58;&#x5728;&#x3002;&#x5982;&#x679C;&#x5B58;&#x5728;&#xFF0C;&#x5219;&#x68C0;&#x67E5;&#x5BC6;&#x7801;&#x662F;&#x5426;&#x7B26;&#x5408;&#x6570;&#x636E;&#x5E93;&#x7684;&#x8BB0;&#x5F55;&#x3002;&#x5982;&#x679C;&#x90AE;&#x7BB1;&#x6216;&#x8005;&#x5BC6;&#x7801;&#x9519;&#x8BEF;&#xFF0C;&#x5C06;&#x8FD4;&#x56DE;null&#x3002;&#x5426;&#x5219;&#x8FD4;&#x56DE;&#x6B63;&#x786E;&#x7684;&#x7528;&#x6237;&#x5BF9;&#x8C61;&#x3002;</span></p>\r\n<p>&#xA0;</p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x6211;&#x8FDB;&#x4E00;&#x6B65;&#x4FEE;&#x6539;&#x63A7;&#x5236;&#x5668;Application&#x3002;&#x8FD9;&#x4E00;&#x6B21;&#x8FD8;&#x662F;&#x589E;&#x52A0;&#x4E24;&#x4E2A;&#x52A8;&#x4F5C;&#x548C;&#x4E00;&#x4E2A;&#x8868;&#x5355;&#x7C7B;&#x3002;&#x52A8;&#x4F5C;login()&#x7528;&#x4E8E;&#x663E;&#x793A;&#x767B;&#x5F55;&#x9875;&#x9762;&#xFF0C;&#x52A8;&#x4F5C;postLogin()&#x7528;&#x4E8E;&#x5904;&#x7406;&#x767B;&#x5F55;&#x8868;&#x5355;&#x586B;&#x5199;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x5E76;&#x6839;&#x636E;&#x4FE1;&#x606F;&#x51B3;&#x5B9A;&#x662F;&#x5426;&#x767B;&#x5165;&#x7528;&#x6237;&#x3002;Login&#x7C7B;&#x5BF9;&#x5E94;&#x767B;&#x5F55;&#x9875;&#x9762;&#x7684;&#x8868;&#x5355;&#x3002;</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-family: &apos;courier new&apos;, courier;\"><span style=\"color: #0000ff;\">package</span><span style=\"color: #000000;\"> controllers;\r\n\r\n</span><span style=\"color: #0000ff;\">import</span> play.*<span style=\"color: #000000;\">;\r\n</span><span style=\"color: #0000ff;\">import</span> play.mvc.*<span style=\"color: #000000;\">;\r\n\r\n</span><span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> play.data.Form;\r\n</span><span style=\"color: #0000ff;\">import</span> play.data.validation.Constraints.*<span style=\"color: #000000;\">;\r\n\r\n</span><span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> models.User;\r\n\r\n</span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span> Application <span style=\"color: #0000ff;\">extends</span><span style=\"color: #000000;\"> Controller {\r\n\r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> Registration {\r\n        @Email\r\n        </span><span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> String email;\r\n        @Required\r\n        </span><span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> String password;\r\n    }\r\n    \r\n    \r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span><span style=\"color: #000000;\"> Result register() {\r\n        Form</span>&lt;Registration&gt; userForm = Form.form(Registration.<span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> ok(views.html.register.render(userForm));\r\n    }\r\n    \r\n\r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span><span style=\"color: #000000;\"> Result postRegister() {\r\n        Form</span>&lt;Registration&gt; userForm =<span style=\"color: #000000;\"> \r\n                Form.form(Registration.</span><span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\">).bindFromRequest();\r\n        User user </span>= <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> User(userForm.get().email, userForm.get().password);\r\n        user.save(); \r\n        </span><span style=\"color: #0000ff;\">return</span> ok(&quot;registered&quot;<span style=\"color: #000000;\">); \r\n    }\r\n\r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> Login {\r\n        @Email\r\n        </span><span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> String email;\r\n        @Required\r\n        </span><span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> String password;\r\n        \r\n        </span><span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> String validate() {\r\n            </span><span style=\"color: #0000ff;\">if</span> (User.authenticate(email, password) == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">) {\r\n                </span><span style=\"color: #0000ff;\">return</span> &quot;Invalid user or password&quot;<span style=\"color: #000000;\">;\r\n            } \r\n            </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n        }\r\n    }\r\n    \r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span><span style=\"color: #000000;\"> Result login() {\r\n        Form</span>&lt;Login&gt; userForm = Form.form(Login.<span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> ok(views.html.login.render(userForm));\r\n    }\r\n    \r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span><span style=\"color: #000000;\"> Result postLogin() {\r\n        Form</span>&lt;Login&gt; userForm = Form.form(Login.<span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\">).bindFromRequest();\r\n        </span><span style=\"color: #0000ff;\">if</span><span style=\"color: #000000;\"> (userForm.hasErrors()) {\r\n            </span><span style=\"color: #0000ff;\">return</span> badRequest(&quot;Wrong user/password&quot;<span style=\"color: #000000;\">);\r\n        } </span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\"> {\r\n            </span><span style=\"color: #0000ff;\">return</span> ok(&quot;Valid user&quot;<span style=\"color: #000000;\">);\r\n        }\r\n    }\r\n}</span></span></pre>\r\n</div>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x4E0A;&#x9762;&#x7684;&#x8868;&#x5355;&#x7C7B;Login&#x4E2D;&#xFF0C;&#x589E;&#x52A0;&#x4E86;validate()&#x65B9;&#x6CD5;&#xFF0C;&#x5E76;&#x5728;&#x5176;&#x4E2D;&#x8C03;&#x7528;User&#x7684;&#x9A8C;&#x8BC1;&#x903B;&#x8F91;&#x3002;&#x6B63;&#x5982;postLogin()&#x4E2D;&#x6240;&#x793A;&#xFF0C;&#x8868;&#x5355;&#x7684;hasErrors()&#x65B9;&#x6CD5;&#x5C06;&#x81EA;&#x52A8;&#x68C0;&#x67E5;validate()&#x65B9;&#x6CD5;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x3002;&#x5982;&#x679C;validate()&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x4E3A;null&#xFF0C;&#x5219;&#x8BF4;&#x660E;&#x8868;&#x5355;&#x65E0;&#x8BEF;&#x3002;postLogin()&#x7684;if&#x7ED3;&#x6784;&#xFF0C;&#x5C06;&#x6839;&#x636E;&#x767B;&#x5F55;&#x662F;&#x5426;&#x5408;&#x6CD5;&#xFF0C;&#x6765;&#x8FD4;&#x56DE;&#x4E0D;&#x540C;&#x7684;&#x7ED3;&#x679C;&#x3002;</span></p>\r\n<p>&#xA0;</p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x4E3A;&#x65B0;&#x589E;&#x7684;&#x52A8;&#x4F5C;&#x589E;&#x52A0;&#x5BF9;&#x5E94;&#x7684;URL&#xFF1A;</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #000000; font-family: &apos;courier new&apos;, courier;\">GET     /login                      controllers.Application.login()\r\nPOST    /login                      controllers.Application.postLogin()</span></pre>\r\n</div>\r\n<p>&#xA0;</p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x8BBF;&#x95EE;/login&#x9875;&#x9762;&#xFF0C;&#x5E76;&#x5C1D;&#x8BD5;&#x767B;&#x5F55;&#x3002;</span></p>\r\n<p>&#xA0;</p>\r\n<h3><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x4F1A;&#x8BDD;</span></h3>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\"><a href=\"http://www.cnblogs.com/vamei/archive/2013/05/11/3069788.html\">HTTP&#x534F;&#x8BAE;&#x662F;&#x65E0;&#x72B6;&#x6001;&#x7684;</a>&#x3002;&#x5373;&#x4F7F;&#x6211;&#x5728;/login&#x767B;&#x5F55;&#x6210;&#x529F;&#xFF0C;&#x4F46;&#x4E0B;&#x4E00;&#x6B21;&#x8BBF;&#x95EE;&#x65F6;&#xFF0C;&#x670D;&#x52A1;&#x5668;&#x53C8;&#x4F1A;&#x5FD8;&#x8BB0;&#x6211;&#x662F;&#x8C01;&#x3002;HTTP&#x534F;&#x8BAE;&#x53EF;&#x4EE5;&#x7528;&#x4F1A;&#x8BDD;(Session)&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x6765;&#x8BB0;&#x5F55;&#x7528;&#x6237;&#x7684;&#x767B;&#x5F55;&#x4FE1;&#x606F;&#x3002;&#x5728;&#x4F1A;&#x8BDD;&#x6709;&#x6548;&#x671F;&#x5185;&#xFF0C;&#x670D;&#x52A1;&#x5668;&#x53EF;&#x4EE5;&#x8BC6;&#x522B;&#x76F8;&#x5E94;&#x5BA2;&#x6237;&#x7684;&#x8BBF;&#x95EE;&#x3002;Play&#x5B9E;&#x73B0;&#x4F1A;&#x8BDD;&#x76F8;&#x5F53;&#x65B9;&#x4FBF;&#x3002;</span></p>\r\n<p>&#xA0;</p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x63D0;&#x4EA4;&#x767B;&#x5F55;&#x8868;&#x683C;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x767B;&#x5F55;&#x5408;&#x6CD5;&#xFF0C;&#x6211;&#x5C06;&#x8BA9;&#x670D;&#x52A1;&#x5668;&#x5F00;&#x542F;&#x548C;&#x8BE5;&#x5BA2;&#x6237;&#x7684;&#x4F1A;&#x8BDD;&#xFF0C;&#x8BB0;&#x5F55;&#x5BA2;&#x6237;&#x7684;&#x4FE1;&#x606F;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x4FEE;&#x6539;postLogin()&#x4E3A;&#xFF1A;</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-family: &apos;courier new&apos;, courier;\"><span style=\"color: #0000ff;\">    public</span> <span style=\"color: #0000ff;\">static</span><span style=\"color: #000000;\"> Result postLogin() {\r\n        Form</span>&lt;Login&gt; userForm = Form.form(Login.<span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\">).bindFromRequest();\r\n        </span><span style=\"color: #0000ff;\">if</span><span style=\"color: #000000;\"> (userForm.hasErrors()) {\r\n            </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> badRequest(views.html.login.render(userForm));\r\n        } </span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\"> {\r\n            session().clear();\r\n            session(</span>&quot;email&quot;<span style=\"color: #000000;\">,userForm.get().email);\r\n            </span><span style=\"color: #0000ff;\">return</span> redirect(&quot;/&quot;<span style=\"color: #000000;\">);\r\n        }\r\n    }</span></span></pre>\r\n</div>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\">&#x8FD9;&#x91CC;&#x7528;&#x6237;&#x767B;&#x5F55;&#x6210;&#x529F;&#x540E;&#xFF0C;&#x5C06;&#x542F;&#x52A8;&#x4E00;&#x4E2A;&#x4F1A;&#x8BDD;&#x3002;&#x5728;&#x4F1A;&#x8BDD;&#x4E2D;&#xFF0C;&#x53EF;&#x653E;&#x5165;&#x952E;&#x503C;&#x5BF9;(key-value pair)&#x5F62;&#x5F0F;&#x7684;&#x4FE1;&#x606F;&#x3002;&#x8FD9;&#x91CC;&#x7684;&#x952E;&#x540D;&#x4E3A;&quot;email&quot;&#xFF0C;&#x5BF9;&#x5E94;&#x503C;&#x4E3A;&#x767B;&#x5F55;&#x7528;&#x6237;&#x7684;&#x90AE;&#x7BB1;&#x5730;&#x5740;&#x3002;&#x767B;&#x5F55;&#x6210;&#x529F;&#x540E;&#x5C06;&#x91CD;&#x65B0;&#x5B9A;&#x5411;&#x5230;/&#x3002;</span></p>\r\n<p>&#xA0;</p>\r\n<p>&#x589E;&#x52A0;index()&#x52A8;&#x4F5C;&#xFF0C;&#x5BF9;&#x5E94;/&#x8FD9;&#x4E00;URL&#x3002;&#x5728;&#x8BE5;&#x52A8;&#x4F5C;&#x4E2D;&#xFF0C;&#x6211;&#x8C03;&#x7528;session&#x4E2D;&#x4FDD;&#x5B58;&#x7684;&#x7528;&#x6237;&#x4FE1;&#x606F;&#xFF1A;</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span><span style=\"color: #000000;\"> Result index() {\r\n        String email </span>= session(&quot;email&quot;<span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #0000ff;\">if</span> (email != <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">) {\r\n            </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> ok(email);\r\n        } </span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\"> {\r\n            </span><span style=\"color: #0000ff;\">return</span> ok(&quot;not login&quot;<span style=\"color: #000000;\">);\r\n        }\r\n    }</span></pre>\r\n</div>\r\n<p>&#xA0;</p>\r\n<p>&#x589E;&#x52A0;routes&#x4E2D;&#x5BF9;&#x5E94;&#x7684;URL&#xFF1A;</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>GET     /                           controllers.Application.index()</pre>\r\n</div>\r\n<p>&#xA0;</p>\r\n<p>&#x8BBF;&#x95EE;/login&#xFF0C;&#x5E76;&#x767B;&#x5F55;&#x3002;&#x6210;&#x529F;&#x767B;&#x5F55;&#x540E;&#x91CD;&#x65B0;&#x5B9A;&#x5411;&#x5230;/&#xFF0C;&#x9875;&#x9762;&#x4E3A;&#xFF1A;</p>\r\n<p><img style=\"display: block; margin-left: auto; margin-right: auto;\" src=\"http://images.cnitblog.com/i/413416/201405/110925355264290.png\" alt=\"\"></p>\r\n<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x4F1A;&#x8BDD;&#x4E2D;&#x7684;&#x4FE1;&#x606F;&#x53EF;&#x4EE5;&#x6301;&#x7EED;&#x5230;&#x4EE5;&#x540E;&#x7684;&#x9875;&#x9762;&#x8BBF;&#x95EE;&#x3002;&#x4E3A;&#x4E86;&#x9500;&#x6BC1;&#x4F1A;&#x8BDD;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x67D0;&#x4E2A;&#x52A8;&#x4F5C;&#x4E2D;&#x8C03;&#x7528;&#xFF1A;</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>session().clear();</pre>\r\n</div>\r\n<p>&#xA0;</p>\r\n<h3>&#x603B;&#x7ED3;</h3>\r\n<p>&#x7528;&#x6237;&#x9A8C;&#x8BC1;</p>\r\n<p>&#x4F1A;&#x8BDD;</p>\r\n<p>&#xA0;</p>\r\n<p><span style=\"font-family: &apos;courier new&apos;, courier;\"><span>&#x6B22;&#x8FCE;&#x7EE7;&#x7EED;&#x9605;&#x8BFB;&#x201C;</span><a href=\"http://www.cnblogs.com/vamei/archive/2013/03/31/2991531.html\">Java&#x5FEB;&#x901F;&#x6559;&#x7A0B;</a><span>&#x201D;&#x7CFB;&#x5217;&#x6587;&#x7AE0;</span></span></p>"}